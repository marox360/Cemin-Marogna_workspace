<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>
    UniBO MotorSport - Graph Plotting Test 2013
</title>
    <link rel="stylesheet" type="text/css" href="../css/jquery.jqChart.css" />
    <link rel="stylesheet" type="text/css" href="../css/jquery.jqRangeSlider.css" />
    <link rel="stylesheet" type="text/css" href="../themes/smoothness/jquery-ui-1.8.21.css" />
    <script src="../js/jquery-1.5.1.min.js" type="text/javascript"></script>
    <script src="../js/jquery.jqChart.min.js" type="text/javascript"></script>
    <script src="../js/jquery.jqRangeSlider.min.js" type="text/javascript"></script>
    <!--[if IE]><script lang="javascript" type="text/javascript" src="../js/excanvas.js"></script><![endif]-->
    
    <script lang="javascript" type="text/javascript">
        var data = [];
        var yValue = 20;
		var paused = 0;
		var show = 0;

        $(document).ready(function () {
        
            $('#jqChart').jqChart({
                title: { text: 'UBM13 GRAPH TEST' }, 
                
                legend: { visible: false }, 
                
                selectionRect: {
                    fillStyle: 'rgba(125,125,125,0.2)',
                    strokeStyle: 'gray',
                    lineWidth: 1
                },
                mouseInteractionMode: 'zooming', // zooming, panning 
                
                /*watermark: {
                    text: 'Â© 2012-2013 UniBO MotorSports',
                    fillStyle: 'red',
                    font: '10px sans-serif',
                    hAlign: 'left',
                    vAlign: 'bottom'
                },*/
			    
			    series: [
                            {
                                type: 'line',
                                strokeStyle: '#0c2c7f',
                                data: data,
                                markers: {
                                    size: 5,
                                    type: 'circle',
                                    strokeStyle: '#FFFF00',
                                    fillStyle: '#d3031b',
                                    lineWidth: 1,
                                    //nullHandling: 'connect' o 'break' per unire l'ultimo valore conosciuto e l'ultimo acquisito in caso di mancanza di dato 
                                    nullHandling: 'connect'
                                }
                            }
                        ],
				axes: [
						{
                            type : 'linear',
                            location : 'left',
                            title: { text: 'Sensor Values', fillStyle : 'green' }
                        },
						{
                            type: 'dateTime',
                            location: 'bottom',
                            title: { text: 'Seconds', fillStyle : 'green' },
                             minimum: new Date(new Date().getTime()-10000),
                             maximum: new Date(),
                             interval: 1
                        }
                ]
            });

            updateChart();
        });


        function updateChart() {            

			yValue += Math.round(Math.random() * 20 - 10);
					
				// add a new element
				data.push([new Date(), yValue]);
				
            if (paused==0) 
			 {
			 if (data.length>100) 
				{
				 	data.splice(0, data.length-100);
				 }
			 $('#jqChart').jqChart('option', 'axes', [{
                            type : 'linear',
                            location : 'left',
                            title: { text: 'Sensor Values', fillStyle : 'green' }
                        },
						{
                            type: 'dateTime',
                            location: 'bottom',
                            title: { text: 'Seconds', fillStyle : 'green' },
                             minimum: new Date(new Date().getTime()-10000),
                             maximum: new Date(),
                             interval: 1
                        }]);
                        
                        $('#jqChart').jqChart('update');
			 }
			 setTimeout("updateChart()", 100);
        }
		
		function start()
		{
			paused = 0;
		}
		
		function pause()
		{
		   if(paused == 0)
		   {
		   		paused = 1;
		   
		   $('#jqChart').jqChart('option', 'axes', [{
                            type : 'linear',
                            location : 'left',
                            title: { text: 'Sensor Values', fillStyle : 'green' },
							zoomEnabled: true
                        },
						{
                            type: 'dateTime',
                            location: 'bottom',
                            title: { text: 'Seconds', fillStyle : 'green' },
                             minimum: new Date(new Date().getTime()-10000),
                             maximum: new Date(),
                             interval: 1,
           
							zoomEnabled: true
                        }]);
		   }	
                 }
                 
                 function showLevels()
        {
        	if(show==0)
        	{
        		show = 1;
        		
        		$('#jqChart').jqChart('option', 'axes', [{
                            type : 'linear',
                            location : 'left',
                            title: { text: 'Sensor Values', fillStyle : 'green' },
							
							plotBands: [
                                            {
                                                fillStyle: 'CCFFCC',
                                                from: 40,
                                                to: 60,
                                                title: 'Good'
                                            },
                                            {
                                                fillStyle: '#FF6666',
                                                from: 60,
                                                to: 70,
                                                title: 'Alert'
                                            },
                                            {
                                                fillStyle: '#FF6666',
                                                from: 20,
                                                to: 40,
                                                title: 'Alert'
                                            }
                                       ]

                        },
						{
                            type: 'dateTime',
                            location: 'bottom',
                            title: { text: 'Seconds', fillStyle : 'green' },
                             minimum: new Date(new Date().getTime()-10000),
                             maximum: new Date(),
                             interval: 1
                      }]);
        	}
        	else
        	{
        		show = 0;
        		
        		$('#jqChart').jqChart('option', 'axes', [{
                            type : 'linear',
                            location : 'left',
                            title: { text: 'Sensor Values', fillStyle : 'green' }
                        },
						{
                            type: 'dateTime',
                            location: 'bottom',
                            title: { text: 'Seconds', fillStyle : 'green' },
                             minimum: new Date(new Date().getTime()-10000),
                             maximum: new Date(),
                             interval: 1
                        }]);
        	}
        }
		
    </script>

</head>
<body>

<div>
        <div id="jqChart" style="width: 600px; height: 400px;">
        </div>
    </div>
    <p>
      <input type="submit" name="Start" id="Start" value="Start" onclick="start()" />
      <input type="submit" name="Pause" id="Pause" value="Pause" onclick="pause()" />
      <input type="submit" name="Levels" id="Levels" value="Show Critical Levels" onclick="showLevels()" />
    </p>
</body>
</html>